# Canyon-effects structure fin whale feeding aggregations at Southern Ocean feeding grounds

*Herr et al. 2025*

## Analysis using R
 This is the main work flow to produce the figures and tables for the results presented in Herr et al. 2025.

 Sripts are designed to run in sequence, i.e. starting with [00 - survey_area_prep](00_-_survey_area_prep.R) all the way through to [*14 - summary_tables_for_pub*](14 - summary_tables_for_pub.R).
 A number of tables and figures are created over the course of the analysis. File names have been adopted to reflect figure and table order as presented in the manuscript. All assets used in the publication is generated by the scripts and can be found under [_PUBLICATION_ASSETS](_PUBLICATION_ASSETS).
 
## Structure
```
./
├── 00 - survey_area_prep.R
├── 01 - soap_data_prep.R
├── 02 - net_trawl_abu_prep.R
├── 03 - net_trawl_length_prep.R
├── 04 - krill_GMM.R
├── 05 - cet_prep.R
├── 06 - cet_distance_sampling.R
├── 07 - oceanography_prep.R
├── 08 - oceanography_model.R
├── 09 - add_env_covars.R
├── 10 - dim_reduction.R
├── 11 - clustering.R
├── 12 - cluster_station_association.R
├── 13 - currents.R
├── 14 - summary_tables_for_pub.R
├── DATA
│   ├── EXTERNAL
│   │   ├── IBCSO
│   │   │   ├── MSM115_IBCSO_ANNUAL_depth.tif
│   │   │   ├── MSM115_IBCSO_island_mask.tif
│   │   │   ├── MSM115_IBCSO_shelf_mask.tif
│   │   │   └── MSM115_dist2shelf_km.tif
│   │   ├── currents_2023.nc
│   ├── MSM115_Cetaceans
│   │   ├── MSM115_Survey_Strata.gpkg
│   │   ├── MSM115_ds_survey.csv
│   │   └── MSM115_opp_sightings.csv
│   ├── MSM115_Expedition.gpkg
│   ├── MSM115_Krill
│   │   ├── MSM115_Net_trawl_abu.xlsx
│   │   └── MSM115_Net_trawl_lengths.xlsx
│   ├── MSM115_Oceanography
│   │   ├── MSM115_oce_data.csv
│   └── MSM115_vector_data.gpkg
├── LICENSE
├── README.md
├── _PUBLICATION_ASSETS
│   ├── Figure 10.png
│   ├── Figure 12.png
│   ├── Figure 13.png
│   ├── Figure 14 legend.txt
│   ├── Figure 14.png
│   ├── Figure 3.png
│   ├── Figure 4.png
│   ├── Figure 6.png
│   ├── Figure 9.png
│   ├── Figure_16.png
│   ├── Table 1.xlsx
│   ├── Table 3.xlsx
│   ├── Table 4.xlsx
│   ├── Table 5.xlsx
│   ├── Table 6.xlsx
│   ├── Table S1.xlsx
│   ├── Table S2.xlsx
│   ├── Table S3.xlsx
│   ├── supp_Figure_1.png
│   ├── supp_Figure_10.png
│   ├── supp_Figure_11.png
│   ├── supp_Figure_12.png
│   ├── supp_Figure_2.png
│   ├── supp_Figure_3.png
│   ├── supp_Figure_4.png
│   ├── supp_Figure_5.png
│   ├── supp_Figure_6.png
│   ├── supp_Figure_7.png
│   ├── supp_Figure_8.png
│   └── supp_Figure_9.png
└── _SRC
    ├── _folders_files.R
    ├── _spatial.R
    ├── _startup.R
    ├── _themes.R
    ├── distance_functions.R
    ├── ggplots.R
    ├── mathematical_functions.R
    ├── pca_functions.R
    └── various.R
```
#### All code was run using the following versions:
- R Version: 4.3.1
- sqldf: 0.4.11
- terra: 1.8.29
- sf: 1.0.20
- ggplot2: 3.5.2
- dplyr: 1.1.4
- oce: 1.8.3
- signal: 1.8.1
- vegan: 2.6.10
- tidyterra: 0.7.2
- factoextra: 1.0.7
- e1071: 1.7.16
- mgcv: 1.9.1
- NbClust: 3.0.1
- ggh4x: 0.3.1
- mclust: 6.1.1
- RColorBrewer: 1.1.3

#### Contact:

sacha.viquerat@awi.de